<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Random Image API</title>
</head>
<body>
<script>
(async () => {
  const ua = navigator.userAgent;
  const isMobile = /iPhone|iPad|iPod|Android/i.test(ua);
  const orientationPref = isMobile ? 'portrait' : 'landscape';

  const res = await fetch('images.json');
  const data = await res.json();

  const candidates = data[orientationPref] || [];
  const all = [...(data.landscape || []), ...(data.portrait || [])];

  const selected = candidates.length > 0
    ? candidates[Math.floor(Math.random() * candidates.length)]
    : all[Math.floor(Math.random() * all.length)];

  // 修复路径：去掉开头的 '/'，并加上仓库目录
  const cleanPath = selected.replace(/^\/+/, '');
  const fullUrl = selected.startsWith('http') 
      ? selected 
      : `${location.origin}${location.pathname}${cleanPath}`;

  window.location.href = fullUrl;
})();
</script>
</body>
</html>
