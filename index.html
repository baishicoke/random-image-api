<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Random Image API</title>
</head>
<body>
<script>
(async () => {
  // 判断设备类型
  const ua = navigator.userAgent;
  const isMobile = /iPhone|iPad|iPod|Android/i.test(ua);
  const orientationPref = isMobile ? 'portrait' : 'landscape';

  // 加载 images.json
  const res = await fetch('images.json');
  const data = await res.json();

  const candidates = data[orientationPref] || [];
  const all = [...(data.landscape || []), ...(data.portrait || [])];

  const selected = candidates.length > 0
    ? candidates[Math.floor(Math.random() * candidates.length)]
    : all[Math.floor(Math.random() * all.length)];

  // 修复本地路径，自动加仓库路径
  const basePath = location.pathname.replace(/\/$/, ''); // 当前仓库路径
  const fullUrl = selected.startsWith('http') 
    ? selected 
    : `${location.origin}${basePath}/${encodeURIComponent(selected)}`;

  // 跳转到图片
  window.location.href = fullUrl;
})();
</script>
</body>
</html>
